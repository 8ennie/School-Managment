<div style="text-align: center; margin: 15px;" *ngIf="load">
    <p-table #dt [value]="imageShows" sortField="brand" sortMode="single" (onSort)="onSort()" selectionMode="single"
        [(selection)]="selectedImageShow" (onRowSelect)="onRowSelect($event)" [paginator]="true" [rows]="15"
        [filterDelay]="0" [globalFilterFields]="['area']">
        <ng-template pTemplate="caption" let-rowData>
            <div style="display: flex; justify-content: center; position: relative;">
                <h1>{{'photoshow' | translate }}</h1>
                <button type="button" pButton icon="pi pi-plus" (click)="showDialogToAdd()"
                    label="{{ 'add' | translate }}" style="position: absolute; right: 15px;"></button>
            </div>
            <p-dropdown id="type" [options]="currentAreas" *ngIf="currentAreas.length > 1"
                placeholder="{{ 'filter-area' | translate }}" appendTo="body"
                (onChange)="dt.filter($event.value,'area','contains')" [showClear]="true">
                <ng-template pTemplate="item" let-area>
                    {{area.value | translate}}
                </ng-template>
                <ng-template pTemplate="selectedItem" let-area>
                    {{area.value | translate}}
                </ng-template>
            </p-dropdown>
        </ng-template>
        <ng-template pTemplate="header">
            <tr>
                <th>{{'image-show-name' | translate }}</th>
                <th>{{'image-count' | translate }}</th>
                <th>{{'date' | translate }}</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-rowIndex="rowIndex">
            <tr class="ui-widget-header" *ngIf="rowGroupMetadata[rowData.area].index === rowIndex">
                <td colspan="3">
                    <span style="font-weight:bold">{{rowData.area | translate}}</span>
                </td>
            </tr>
            <tr [pSelectableRow]="rowData">
                <td>{{rowData.name}}</td>
                <td>{{rowData.imageCount}}</td>
                <td>{{rowData.date}}</td>
            </tr>
        </ng-template>
    </p-table>

    <p-dialog header="{{ 'image-show-details' | translate }}" [(visible)]="displayDialog" [focusOnShow]="false"
        showEffect="fade" [modal]="true" [style]="{width: '50vw'}">
        <div class="p-grid ui-fluid" *ngIf="imageShow">
            <div class="p-g-4">
                <label for="area">{{'area' | translate }}</label>
            </div>
            <div class="p-g-8">
                <p-dropdown id="area" [options]="areas" [(ngModel)]="imageShow.area" required="true"
                    placeholder="{{ 'choose-area' | translate }}" appendTo="body">
                    <ng-template pTemplate="item" let-item>
                        {{item.value | translate}}
                    </ng-template>
                    <ng-template pTemplate="selectedItem" let-item>
                        {{item.value | translate}}
                    </ng-template>
                </p-dropdown>
            </div>

            <div class="p-col-4">
                <label for="name">{{'image-show-name' | translate }}</label>
            </div>
            <div class="p-col-8">
                <input pInputText id="name" [(ngModel)]="imageShow.name" required="true" style="width: 100%;"
                    [disabled]="!newImageShow" />
            </div>
            <ng-container *ngIf="newImageShow">
                <div class="p-col-4">
                    <label for="name">{{'upload-file' | translate }}</label>
                </div>
                <div class="p-col-8">
                    <p-fileUpload required="true" #fileUpload accept=".pdf" [showCancelButton]="false"
                    [showUploadButton]="false" chooseLabel="{{'choose' | translate }}"></p-fileUpload>
                </div>
                <div class="p-col-4">
                    <label for="upadteMonitors">{{'create-image-show' | translate }}</label>
                </div>
                <div class="p-col-8">
                    <p-checkbox name="upadteMonitors" [(ngModel)]="createImageShow" binary="true"></p-checkbox>
                </div>
            </ng-container>


            <ng-container *ngIf="!newImageShow">
                <div class="p-col-4">
                    <label for="name">{{'image-show' | translate }}</label>
                </div>
                <div class="p-col-8">
                    <button pButton type="button" 
                        [label]="displayImages? ('hide-image-show' | translate) : 'show-image-show' | translate "></button>
                </div>
            </ng-container>
            <div class="alert alert-danger" style="width: 100%; text-align: center; margin-top: 5px;" role="alert"
                *ngIf="errorMessage">
                <div>{{ errorMessage | translate }}</div>
            </div>
        </div>
        <p-footer>
            <div class="p-dialog-buttonpane p-helper-clearfix">
                <button *ngIf="!newImageShow" type="button" pButton icon="pi pi-times" (click)="delete()"
                    label="{{ 'delete' | translate }}"></button>
                <button *ngIf="!newImageShow" type="button" pButton icon="pi pi-check" (click)="close()"
                    label="{{ 'close' | translate }}"></button>
                <button type="button" pButton icon="pi pi-check" (click)="save()"
                    label="{{ 'save' | translate }}"></button>
            </div>
        </p-footer>
    </p-dialog>
</div>